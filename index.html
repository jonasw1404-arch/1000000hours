<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Glücksrad-Spiel</title>
<style>
  body { font-family: Arial, sans-serif; text-align: center; background: #f0f0f0; margin: 0; padding: 20px; }
  h1 { color: #333; }
  #wheel { margin: 20px auto; width: 300px; height: 300px; border: 10px solid #333; border-radius: 50%; position: relative; overflow: hidden; }
  .segment { width: 50%; height: 50%; position: absolute; top: 50%; left: 50%; transform-origin: 0 0; }
  .red { background-color: red; clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
  .gray { background-color: gray; clip-path: polygon(0 0, 100% 0, 100% 100%, 0 100%); }
  #spinBtn { padding: 10px 20px; font-size: 18px; margin-top: 20px; cursor: pointer; }
  #info { margin-top: 20px; font-size: 18px; }
  #upgrades { margin-top: 30px; display: flex; justify-content: center; flex-wrap: wrap; gap: 10px; }
  .upgrade { padding: 10px; background: #fff; border: 1px solid #333; border-radius: 8px; cursor: pointer; width: 180px; }
  .upgrade:disabled { background: #ccc; cursor: not-allowed; }
</style>
</head>
<body>

<h1>Glücksrad-Spiel</h1>
<div id="wheel"></div>
<button id="spinBtn">Drehen</button>

<div id="info">
  Punkte: <span id="points">0</span> | Kette: <span id="streak">0</span>/5 | Joker: <span id="joker">0</span>
</div>

<div id="upgrades">
  <button class="upgrade" id="upgradeSize">Fläche +5% (Kosten: 3)</button>
  <button class="upgrade" id="buyJoker">Joker +1 (Kosten: 5)</button>
  <button class="upgrade" id="upgradeBonus">Punkte x2 (Kosten: 7)</button>
  <button class="upgrade" id="upgradeChain">Ketten-Schutz +1 (Kosten: 10)</button>
  <button class="upgrade" id="upgradeTalisman">Glücks-Talisman +10% (Kosten: 8)</button>
</div>

<script>
let points = 0;
let streak = 0;
let spinCount = 0;

let baseChance = 0.25; // Grundchance für farbige Fläche
let sizeBonus = 0; // durch Upgrade
let talismanBonus = 0;
let jokerCount = 0;
let doublePoints = false;
let chainShield = 0;

const streakGoal = 5;

const pointsEl = document.getElementById("points");
const streakEl = document.getElementById("streak");
const jokerEl = document.getElementById("joker");
const wheelEl = document.getElementById("wheel");

function updateWheel() {
  wheelEl.innerHTML = "";
  const totalChance = Math.min(baseChance + sizeBonus + talismanBonus, 0.8);
  const redAngle = totalChance * 360;
  const grayAngle = 360 - redAngle;

  const red = document.createElement("div");
  red.classList.add("segment", "red");
  red.style.transform = `rotate(0deg) skewY(-60deg)`;
  wheelEl.appendChild(red);

  const gray = document.createElement("div");
  gray.classList.add("segment", "gray");
  gray.style.transform = `rotate(${redAngle}deg) skewY(-60deg)`;
  wheelEl.appendChild(gray);
}

updateWheel();

function spinWheel() {
  if (streak >= streakGoal) {
    alert("Du hast die Kette bereits geschafft! Setze zurück für neue Runde.");
    return;
  }

  let totalChance = Math.min(baseChance + sizeBonus + talismanBonus, 0.8);

  let success = Math.random() < totalChance;

  // Joker verwenden
  if (!success && jokerCount > 0) {
    success = true;
    jokerCount--;
    alert("Joker benutzt! Dreh erfolgreich.");
  }

  if (success) {
    streak++;
    points += doublePoints ? 2 : 1;
    if (streak === streakGoal) {
      points += 5; // Bonus
      alert("Kette geschafft! Bonus +5 Punkte");
      streak = 0;
    }
  } else {
    if (chainShield > 0) {
      chainShield--;
      alert("Ketten-Schutz aktiviert! Kette bleibt erhalten.");
    } else {
      streak = 0;
    }
  }

  updateDisplay();
}

function updateDisplay() {
  pointsEl.textContent = points;
  streakEl.textContent = streak;
  jokerEl.textContent = jokerCount;
}

// Upgrade Buttons
document.getElementById("upgradeSize").addEventListener("click", () => {
  const cost = 3;
  if (points >= cost && sizeBonus < 0.25) {
    points -= cost;
    sizeBonus += 0.05;
    updateWheel();
    updateDisplay();
  }
});

document.getElementById("buyJoker").addEventListener("click", () => {
  const cost = 5;
  if (points >= cost) {
    points -= cost;
    jokerCount++;
    updateDisplay();
  }
});

document.getElementById("upgradeBonus").addEventListener("click", () => {
  const cost = 7;
  if (points >= cost) {
    points -= cost;
    doublePoints = true;
    updateDisplay();
  }
});

document.getElementById("upgradeChain").addEventListener("click", () => {
  const cost = 10;
  if (points >= cost) {
    points -= cost;
    chainShield++;
    updateDisplay();
  }
});

document.getElementById("upgradeTalisman").addEventListener("click", () => {
  const cost = 8;
  if (points >= cost && talismanBonus < 0.3) {
    points -= cost;
    talismanBonus += 0.1;
    updateWheel();
    updateDisplay();
  }
});

document.getElementById("spinBtn").addEventListener("click", spinWheel);
</script>

</body>
</html>
